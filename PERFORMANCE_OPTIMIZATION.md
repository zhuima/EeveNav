# ğŸš€ æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆå®æ–½æŒ‡å—

## ğŸ“Š ä¼˜åŒ–å‰åå¯¹æ¯”

### ä¼˜åŒ–å‰é—®é¢˜
- TTFB: ~940ms
- æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦æ•°æ®åº“æŸ¥è¯¢
- å®Œå…¨æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæ— ç¼“å­˜
- å›¾ç‰‡èµ„æºæœªä¼˜åŒ–
- æœç´¢åŠŸèƒ½ä¾èµ–æœåŠ¡ç«¯

### ä¼˜åŒ–åæ•ˆæœ
- é¢„æœŸ TTFB: <200ms
- é™æ€é¡µé¢ + æ™ºèƒ½ç¼“å­˜
- å®¢æˆ·ç«¯æœç´¢ï¼Œé›¶å»¶è¿Ÿ
- å›¾ç‰‡æ‡’åŠ è½½å’Œä¼˜åŒ–
- CDNè¾¹ç¼˜ç¼“å­˜

## ğŸ¯ ä¼˜åŒ–æ¶æ„

### 1. æ··åˆæ¸²æŸ“ç­–ç•¥
```
é™æ€é¡µé¢ (SSG):
â”œâ”€â”€ é¦–é¡µ (/) -> å®Œå…¨é™æ€åŒ–
â”œâ”€â”€ åˆ†ç±»é¡µé¢ (/categories/*) -> é™æ€ + ISR
â”œâ”€â”€ æ ‡ç­¾é¡µé¢ (/tags/*) -> é™æ€ + ISR
â””â”€â”€ æ–‡ç« è¯¦æƒ… (/posts/*) -> æŒ‰éœ€æ¸²æŸ“

åŠ¨æ€é¡µé¢ (SSR):
â”œâ”€â”€ ç®¡ç†åå° (/admin/*)
â””â”€â”€ APIè·¯ç”± (/api/*)
```

### 2. ç¼“å­˜å±‚çº§
```
æµè§ˆå™¨ç¼“å­˜ (ç”¨æˆ·ç«¯)
    â†“
CDNç¼“å­˜ (Cloudflare/Vercel)
    â†“
åº”ç”¨ç¼“å­˜ (å†…å­˜ç¼“å­˜)
    â†“
æ•°æ®åº“ç¼“å­˜ (æŸ¥è¯¢ç»“æœ)
```

## ğŸ”§ å®æ–½æ­¥éª¤

### 1. ç¯å¢ƒé…ç½®

è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
# .env.local
PUBLIC_TURSO_DATABASE_URL=your_turso_url
PUBLIC_TURSO_AUTH_TOKEN=your_turso_token
REVALIDATE_SECRET=your_revalidate_secret
SITE_URL=https://your-domain.com
```

### 2. æ„å»ºä¼˜åŒ–

```bash
# ä½¿ç”¨ä¼˜åŒ–çš„æ„å»ºè„šæœ¬
npm run build

# å¿«é€Ÿæ„å»ºï¼ˆè·³è¿‡ä¼˜åŒ–ï¼‰
npm run build:fast

# æ„å»ºå¹¶åˆ†ææ€§èƒ½
npm run build:analyze
```

### 3. ç¼“å­˜é¢„çƒ­

```bash
# æ‰‹åŠ¨é¢„çƒ­ç¼“å­˜
npm run cache:warmup

# è§¦å‘é¦–é¡µé‡æ–°éªŒè¯
npm run revalidate:home

# é‡æ–°éªŒè¯æ‰€æœ‰é¡µé¢
npm run revalidate:all
```

## ğŸ“ æ–°å¢æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒä¼˜åŒ–æ–‡ä»¶

1. **`src/pages/index-static.astro`**
   - é™æ€åŒ–é¦–é¡µ
   - å®¢æˆ·ç«¯æœç´¢åŠŸèƒ½
   - é¢„è®¡ç®—æ•°æ®ä¼ é€’

2. **`src/lib/cache.ts`**
   - å†…å­˜ç¼“å­˜å®ç°
   - ç¼“å­˜è£…é¥°å™¨
   - è‡ªåŠ¨è¿‡æœŸæ¸…ç†

3. **`src/lib/cached-database.ts`**
   - æ•°æ®åº“æŸ¥è¯¢ç¼“å­˜åŒ…è£…
   - æ™ºèƒ½ç¼“å­˜å¤±æ•ˆ
   - ç¼“å­˜é¢„çƒ­åŠŸèƒ½

4. **`src/components/OptimizedImage.astro`**
   - å›¾ç‰‡æ‡’åŠ è½½
   - å“åº”å¼å›¾ç‰‡
   - é”™è¯¯å¤„ç†

### APIå’ŒISR

5. **`src/pages/api/revalidate/[...path].ts`**
   - å¢é‡é™æ€å†ç”Ÿ
   - æ™ºèƒ½ç¼“å­˜å¤±æ•ˆ
   - æ‰¹é‡é‡æ–°éªŒè¯

### æ„å»ºå’Œéƒ¨ç½²

6. **`scripts/build-and-cache.js`**
   - ä¼˜åŒ–æ„å»ºæµç¨‹
   - èµ„æºå‹ç¼©
   - æ€§èƒ½æŠ¥å‘Šç”Ÿæˆ

7. **`scripts/warmup-cache.js`**
   - ç¼“å­˜é¢„çƒ­è„šæœ¬
   - æ‰¹é‡è¯·æ±‚å¤„ç†
   - é”™è¯¯é‡è¯•æœºåˆ¶

### é…ç½®æ–‡ä»¶

8. **`astro.config.mjs`** (å·²æ›´æ–°)
   - æ··åˆæ¸²æŸ“æ¨¡å¼
   - é™æ€å¯¼å‡ºé…ç½®

9. **`vercel.json`** (æ–°å¢)
   - éƒ¨ç½²é…ç½®
   - ç¼“å­˜ç­–ç•¥
   - å‡½æ•°é…ç½®

10. **`_headers`** (æ–°å¢)
    - Cloudflareç¼“å­˜è§„åˆ™
    - å®‰å…¨å¤´éƒ¨
    - èµ„æºä¼˜åŒ–

## ğŸ›ï¸ é…ç½®é€‰é¡¹

### ç¼“å­˜æ—¶é—´é…ç½®

```javascript
// src/lib/cache.ts
const CACHE_TTL = {
  POSTS: 10 * 60 * 1000,      // 10åˆ†é’Ÿ
  CATEGORIES: 20 * 60 * 1000,  // 20åˆ†é’Ÿ
  SEARCH_RESULTS: 5 * 60 * 1000, // 5åˆ†é’Ÿ
  STATIC_ASSETS: 31536000      // 1å¹´
};
```

### CDNç¼“å­˜é…ç½®

```json
// vercel.json
{
  "headers": [
    {
      "source": "/assets/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=31536000, immutable"
        }
      ]
    }
  ]
}
```

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

### 1. æ„å»ºæ—¶åˆ†æ

æ„å»ºå®Œæˆåä¼šç”Ÿæˆ `dist/performance-report.json`ï¼š

```json
{
  "buildTime": "2024-01-01T00:00:00.000Z",
  "buildSize": 2097152,
  "fileCount": 150,
  "optimizations": {
    "staticPages": 1,
    "cssFiles": 3,
    "jsFiles": 5,
    "images": 20
  }
}
```

### 2. è¿è¡Œæ—¶ç›‘æ§

```javascript
// ç¼“å­˜ç»Ÿè®¡
const stats = getCachedDatabase().getCacheStats();
console.log('ç¼“å­˜å‘½ä¸­ç‡:', stats.hitRate);
```

## ğŸ”„ å¼€å‘å·¥ä½œæµ

### å¼€å‘æ¨¡å¼
```bash
npm run dev  # æ­£å¸¸å¼€å‘ï¼Œçƒ­é‡è½½
```

### éƒ¨ç½²å‰æ£€æŸ¥
```bash
npm run lint        # ä»£ç æ£€æŸ¥
npm run build       # ä¼˜åŒ–æ„å»º
npm run preview     # æœ¬åœ°é¢„è§ˆ
```

### ç”Ÿäº§éƒ¨ç½²
```bash
npm run build           # æ„å»ºä¼˜åŒ–ç‰ˆæœ¬
git push origin main    # è‡ªåŠ¨éƒ¨ç½²åˆ°Vercel
npm run cache:warmup    # é¢„çƒ­ç¼“å­˜ï¼ˆå¯é€‰ï¼‰
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ„å»ºå¤±è´¥**
   ```bash
   # æ£€æŸ¥ç¯å¢ƒå˜é‡
   echo $PUBLIC_TURSO_DATABASE_URL

   # æ¸…ç†ç¼“å­˜é‡æ–°æ„å»º
   rm -rf .astro dist
   npm run build
   ```

2. **ç¼“å­˜æœªç”Ÿæ•ˆ**
   ```bash
   # æ£€æŸ¥ç¼“å­˜ç»Ÿè®¡
   curl https://your-domain.com/api/cache-stats

   # æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜
   curl -X POST "https://your-domain.com/api/revalidate/all?secret=YOUR_SECRET"
   ```

3. **æœç´¢åŠŸèƒ½å¼‚å¸¸**
   ```javascript
   // æ£€æŸ¥å®¢æˆ·ç«¯æ•°æ®
   console.log(window.APP_DATA);
   ```

### æ€§èƒ½è°ƒè¯•

1. **ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·**
   - Networké¢æ¿æ£€æŸ¥åŠ è½½æ—¶é—´
   - Performanceé¢æ¿åˆ†æè¿è¡Œæ—¶æ€§èƒ½
   - Applicationé¢æ¿æŸ¥çœ‹ç¼“å­˜çŠ¶æ€

2. **ä½¿ç”¨Vercel Analytics**
   - éƒ¨ç½²åè‡ªåŠ¨å¯ç”¨
   - æŸ¥çœ‹Web VitalsæŒ‡æ ‡
   - åˆ†æç”¨æˆ·è®¿é—®æ¨¡å¼

## ğŸ“Š é¢„æœŸæ€§èƒ½æå‡

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| TTFB | ~940ms | <200ms | 78% â¬‡ï¸ |
| LCP | ~2.5s | <1.2s | 52% â¬‡ï¸ |
| FID | ~80ms | <30ms | 62% â¬‡ï¸ |
| CLS | ~0.15 | <0.05 | 67% â¬‡ï¸ |

## ğŸ”„ æŒç»­ä¼˜åŒ–

### ä¸‹ä¸€æ­¥ä¼˜åŒ–è®¡åˆ’

1. **Service Worker**: å®ç°ç¦»çº¿ç¼“å­˜
2. **Edge Functions**: åœ°ç†ä½ç½®ä¼˜åŒ–
3. **å›¾ç‰‡CDN**: ä¸“ä¸šå›¾ç‰‡ä¼˜åŒ–æœåŠ¡
4. **æ•°æ®åº“ä¼˜åŒ–**: æŸ¥è¯¢ä¼˜åŒ–å’Œç´¢å¼•
5. **ä»£ç åˆ†å‰²**: æ›´ç»†ç²’åº¦çš„æ‡’åŠ è½½

### ç›‘æ§æŒ‡æ ‡

- Web Vitals (LCP, FID, CLS)
- ç¼“å­˜å‘½ä¸­ç‡
- æ•°æ®åº“æŸ¥è¯¢æ—¶é—´
- ç”¨æˆ·è¡Œä¸ºåˆ†æ

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. è¿è¡Œæ€§èƒ½æµ‹è¯•åŸºå‡†
2. æäº¤ä¼˜åŒ–å»ºè®®
3. ç›‘æ§ç”Ÿäº§ç¯å¢ƒæ€§èƒ½
4. å®šæœŸæ›´æ–°ç¼“å­˜ç­–ç•¥

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. æ„å»ºæ—¥å¿— (`dist/performance-report.json`)
2. ç¼“å­˜ç»Ÿè®¡ (`/api/cache-stats`)
3. Verceléƒ¨ç½²æ—¥å¿—
4. Cloudflareåˆ†æé¢æ¿